graph LR
    %% Left Side - Core Entities
    subgraph Core[" ğŸ—‚ï¸ CORE ENTITIES "]
        USER["ğŸ‘¤ USER<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“§ email UK<br/>ğŸ‘¤ hoTen<br/>ğŸ”’ matKhau<br/>ğŸ“± soDienThoai<br/>ğŸ­ vaiTro<br/>â­ diemTichLuy"]

        PRODUCT["ğŸ“¦ PRODUCT<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ”— slug UK<br/>ğŸ“ ten<br/>ğŸ’° gia<br/>ğŸ·ï¸ giaKhuyenMai<br/>ğŸ”– danhMuc FK<br/>ğŸ“Š soLuongTonKho<br/>ğŸ“ˆ daBan"]

        ORDER["ğŸ›’ ORDER<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“‹ maDonHang UK<br/>ğŸ‘¤ nguoiDung FK<br/>ğŸ“¦ sanPham Array<br/>ğŸ’µ tongTien<br/>ğŸ’³ tongThanhToan<br/>ğŸ“ trangThaiDonHang"]

        CATEGORY["ğŸ“‚ CATEGORY<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“ ten UK<br/>ğŸ”— slug UK<br/>â¬†ï¸ danhMucCha FK<br/>âœ… trangThai"]
    end

    %% Middle - Transaction Entities
    subgraph Trans[" âš¡ TRANSACTIONS "]
        REVIEW["â­ REVIEW<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“¦ sanPham FK<br/>ğŸ‘¤ nguoiDung FK<br/>ğŸ›’ donHang FK<br/>â­ danhGia<br/>ğŸ’¬ noiDung"]

        POINT["ğŸ’ POINT_TX<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ‘¤ nguoiDung FK<br/>ğŸ›’ donHang FK<br/>â•â– loai<br/>ğŸ”¢ soLuong"]

        NOTIF["ğŸ”” NOTIFICATION<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ‘¤ nguoiNhan FK<br/>ğŸ›’ donHang FK<br/>âœ… daDoc<br/>ğŸ“Œ loai"]
    end

    %% Right Side - Support Entities
    subgraph Supp[" ğŸ SUPPORT "]
        VOUCHER["ğŸŸï¸ VOUCHER<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ·ï¸ ma UK<br/>ğŸ’¯ loai<br/>ğŸ’° giaTriGiam<br/>ğŸ“Š soLuong"]

        NEWS["ğŸ“° NEWSLETTER<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“§ email UK<br/>âœ… isActive"]

        BRAND["ğŸ¢ BRAND<br/>â”â”â”â”â”â”â”â”â”<br/>ğŸ”‘ _id PK<br/>ğŸ“ ten UK<br/>ğŸ”— slug UK<br/>ğŸ–¼ï¸ logo"]
    end

    %% Relationships
    USER ==>|1:N places| ORDER
    USER ==>|1:N writes| REVIEW
    USER ==>|1:N receives| NOTIF
    USER ==>|1:N earns| POINT
    USER <-.->|N:N favorites| PRODUCT
    USER <-.->|N:N uses| VOUCHER

    PRODUCT ==>|N:1 in| CATEGORY
    PRODUCT ==>|1:N has| REVIEW
    PRODUCT <-.->|N:N contains| ORDER

    ORDER ==>|1:N triggers| NOTIF
    ORDER ==>|1:N generates| POINT
    ORDER -.->|N:1 applies| VOUCHER
    ORDER ==>|1:N reviewed| REVIEW

    CATEGORY -.->|self ref| CATEGORY

    REVIEW ==>|1:N notify| NOTIF
    REVIEW -.->|reply by| USER

    %% Styling
    classDef userClass fill:#16A34A,stroke:#15803D,stroke-width:3px,color:#fff,font-weight:bold
    classDef productClass fill:#3B82F6,stroke:#2563EB,stroke-width:3px,color:#fff,font-weight:bold
    classDef orderClass fill:#DC2626,stroke:#B91C1C,stroke-width:3px,color:#fff,font-weight:bold
    classDef categoryClass fill:#8B5CF6,stroke:#7C3AED,stroke-width:3px,color:#fff,font-weight:bold
    classDef reviewClass fill:#F59E0B,stroke:#D97706,stroke-width:3px,color:#000,font-weight:bold
    classDef notifClass fill:#EC4899,stroke:#DB2777,stroke-width:3px,color:#fff,font-weight:bold
    classDef voucherClass fill:#14B8A6,stroke:#0D9488,stroke-width:3px,color:#fff,font-weight:bold
    classDef pointClass fill:#6366F1,stroke:#4F46E5,stroke-width:3px,color:#fff,font-weight:bold
    classDef supportClass fill:#64748B,stroke:#475569,stroke-width:3px,color:#fff,font-weight:bold

    class USER userClass
    class PRODUCT productClass
    class ORDER orderClass
    class CATEGORY categoryClass
    class REVIEW reviewClass
    class NOTIF notifClass
    class VOUCHER voucherClass
    class POINT pointClass
    class NEWS,BRAND supportClass

    style Core fill:#f0fdf4,stroke:#16a34a,stroke-width:3px,stroke-dasharray: 5 5
    style Trans fill:#fef3c7,stroke:#f59e0b,stroke-width:3px,stroke-dasharray: 5 5
    style Supp fill:#f3f4f6,stroke:#6b7280,stroke-width:3px,stroke-dasharray: 5 5
